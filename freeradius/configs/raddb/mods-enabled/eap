# RADIUS EAP Configuration File
# This is a mostly upstream configuration file for FreeRADIUS EAP module, but with a few adjustments to support
# multiple separate certs / CAs for MS-CHAPv2 (PEAP) and other EAP types (TLS, TTLS).

eap {
        default_eap_type = peap
        timer_expire = 60
        ignore_unknown_eap_types = no
        cisco_accounting_username_bug = no
        max_sessions = ${max_requests}
        md5 {
        }
        gtc {
                auth_type = PAP
        }
        tls-config tls-peap {
                private_key_file = /certs/peap/server.key
                certificate_file = /certs/peap/fullchain.pem
                cipher_list = "HIGH"
                ecdh_curve = "prime256v1"
                cache {
                        enable = yes
                        lifetime = 24 # hours
                        max_entries = 255
                }
                verify {
                }
                ocsp {
                        enable = no
                        override_cert_url = yes
                        url = "http://127.0.0.1/ocsp/"
                }
        }
        tls-config tls-common {
                certificate_file = /certs/eap/server.crt
                private_key_file = /certs/eap/server.key
                ca_file = /certs/eap/ca.pem
                ca_path = ${cadir}
                cipher_list = "DEFAULT"
                cipher_server_preference = no
                tls_min_version = "1.2"
                tls_max_version = "1.2"
                ecdh_curve = ""
                cache {
                        enable = yes
                        lifetime = 24 # hours
                        store {
                                Tunnel-Private-Group-Id
                        }
                }
                verify {
                }
                ocsp {
                        enable = no
                        override_cert_url = yes
                        url = "http://127.0.0.1/ocsp/"
                }
        }
        tls {
                tls = tls-common
        }
        ttls {
                tls = tls-common
                default_eap_type = md5
                copy_request_to_tunnel = no
                use_tunneled_reply = no
                virtual_server = "inner-tunnel"
        }
        peap {
                tls = tls-peap
                default_eap_type = mschapv2
                copy_request_to_tunnel = no
                use_tunneled_reply = no
                virtual_server = "inner-tunnel"
        }
        mschapv2 {
        }
}
